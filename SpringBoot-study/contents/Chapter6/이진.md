# 6-1 Spring Boot Properties
- 설정 파일 작성
- Spring Boot Profiles
- Configuration을 통한 Bean 생성

지금까지의 개발환경 : 자신의 컴퓨터 (JDK, MySQL, IDEA)

>실제로 서비스를 제공하는 입장에서는 
서버 컴퓨터 or 컨테이너 or 클라우드 서비스 (on demand 방식)
실제 서비스를 실행하는 데는 여러가지 다양한 환경을 구성할 수 있다.

application.yml 
상황에 맞는 설정을 사용하여 구성할 수 있음 (테스트 환경, 컨테이너환경, 로컬 등등)

multi document 분리 
>spring.config.activate.on-profile 사용

jar 실행 시 profile을 결정 할 수 있다
> 로컬에서는 kafka를 사용하고 로컬이 아닌 환경에서는 RabbitMQ를 사용한다고 해보자 
1. 인터페이스 정의
~~~java
public interface MessageQueueInterface {
    String readMessage();
}
~~~
2-1. kafka 구현
> 컴포넌트 주입 후 프로파일 설정
~~~java
@Component
@Profile("local")
public class KafkaMQ implements MessageQueueInterface {

    private static final Logger logger = LoggerFactory.getLogger(KafkaMQ.class);
    public KafkaMQ() {
        logger.info("kafka component");
    }


    @Override
    public String readMessage() {
        //code form communicationd with Kafka
        //
        return "message from kafka";
    }
}

~~~
2-2. RabbitMQ 
~~~java
@Component
@Profile("!local")
public class RabbitMQ implements MessageQueueInterface{
    private static final Logger logger = LoggerFactory.getLogger(RabbitMQ.class);
    public RabbitMQ() {
        logger.info("rabbitmq component");
    }

    @Override
    public String readMessage() {
        //code form communicationd with RabbirMQ
        return "message from rabbitmq";
    }
}

~~~

### 설정 파일 안에 다양한 변수를 정의 

~~~java
custom:
property:
single: custom-property
comlist: comma,sparated,list,to,value
ncp:
id: api-id
key: api-key
url: https://ncp.com
~~~

~~~java
@Configuration
public class DemoConfig {
    private static final Logger logger = LoggerFactory.getLogger(DemoConfig.class);


    @Value("${custom.property.single}")
    private String customProperty;

    @Value("${custom.property.default:default-property}")
    private String propertyDefault;
    @Value("${custom.property.comlist}")
    private List<String> customCommaList;
    @PostConstruct
    public void init(){
        logger.info("custom property: {}", customProperty);
        for(String commaListItem: customCommaList){
            logger.info("comma list item : {}", commaListItem);
        }
        logger.info("default property : {}", propertyDefault);
~~~

### 외부라이브러리의 class 도 @Bean 이용해서 제공 
> implementation 'com.google.code.gson:gson:2.8.5'
~~~java
@Bean
    public Gson gson(){
        return new Gson();
    }
~~~

~~~ java
 public PostController(@Autowired PostService postService,
                          @Autowired Gson gson){
        this.postService = postService;
        logger.info(gson.toString());
    }

~~~
